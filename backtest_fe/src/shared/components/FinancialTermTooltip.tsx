import React from 'react';
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from '../ui/tooltip';

interface FinancialTermTooltipProps {
  term: string;
  children: React.ReactNode;
  className?: string;
}

// 금융용어 설명 데이터
const financialTerms: Record<string, string> = {
  // 성과 지표
  '샤프 비율': '위험 대비 수익률을 측정하는 지표. 높을수록 좋음. (수익률 - 무위험수익률) / 변동성으로 계산됩니다.',
  '최대 손실': '백테스트 기간 중 최고점에서 최저점까지의 최대 하락폭. 투자 위험도를 나타냅니다.',
  '드로우다운': '최고점 대비 현재 손실률. 포트폴리오가 얼마나 하락했는지를 보여줍니다.',
  '변동성': '가격의 변동 정도를 나타내는 지표. 높을수록 위험하지만 수익 기회도 클 수 있습니다.',
  '수익률': '투자 원금 대비 얻은 이익의 비율. 연간수익률은 1년 기준으로 환산한 값입니다.',
  '승률': '전체 거래 중 수익을 낸 거래의 비율. 높을수록 안정적인 전략을 의미합니다.',
  '프로핏 팩터': '총 수익 / 총 손실 비율. 1보다 크면 수익성 있는 전략을 의미합니다.',
  '연간 수익률': '1년 기준으로 환산한 수익률. 장기 투자 성과를 비교할 때 유용합니다.',
  '연간 변동성': '연단위로 환산한 가격 변동성. 투자 위험의 척도로 사용됩니다.',

  // 백테스트 관련
  '백테스트': '과거 데이터를 사용해 투자 전략의 성과를 미리 검증하는 방법입니다.',
  '백테스트 기간': '전략을 테스트할 시작 날짜와 종료 날짜. 충분히 긴 기간을 권장합니다.',
  '거래수': '백테스트 기간 중 실행된 매매 거래의 총 횟수입니다.',
  '기간': '백테스트를 실행한 전체 날짜 범위를 의미합니다.',

  // 포트폴리오 관련
  '포트폴리오': '여러 자산을 조합한 투자 묶음. 분산투자로 위험을 줄이는 효과가 있습니다.',
  '포트폴리오 구성': '투자할 자산들의 종류와 각각의 투자 금액 또는 비중을 의미합니다.',
  '투자 금액': '각 자산에 투자할 금액. 실제 백테스트에서 사용되는 초기 자본입니다.',
  '투자 비중': '전체 자산 중 각 자산이 차지하는 비율(%). 합계는 100%가 되어야 합니다.',
  '자산': '투자 대상이 되는 주식, ETF, 현금 등의 금융 상품을 의미합니다.',
  '종목': '거래소에 상장된 개별 주식이나 ETF를 의미합니다.',
  '티커': '주식이나 ETF를 구분하는 고유 코드. 예: AAPL (애플), SPY (S&P 500 ETF)',
  '초기자본': '백테스트 시작 시점의 투자 원금입니다.',
  '최종자본': '백테스트 종료 시점의 총 자산 가치입니다.',
  '최고자본': '백테스트 기간 중 달성한 최고 자산 가치입니다.',

  // 리밸런싱 관련
  '리밸런싱': '목표 비중에 맞게 포트폴리오를 주기적으로 조정하는 것입니다.',
  '리밸런싱 주기': '포트폴리오를 재조정하는 간격. 월별, 분기별, 연간 등을 선택할 수 있습니다.',
  '월별 리밸런싱': '매월 포트폴리오를 목표 비중으로 재조정합니다. 가장 빈번한 방식입니다.',
  '분기별 리밸런싱': '3개월마다 포트폴리오를 재조정합니다. 수수료를 줄이면서 균형을 유지합니다.',
  '연간 리밸런싱': '1년에 한 번 포트폴리오를 재조정합니다. 장기 투자에 적합합니다.',

  // 투자 방식
  '일시 투자': '한 번에 전체 금액을 투자하는 방식. 시장 타이밍이 중요합니다.',
  '분할매수': '일정 기간마다 같은 금액으로 매수하여 평균 단가를 낮추는 투자 방법입니다.',
  'DCA': 'Dollar Cost Averaging의 줄임말. 분할매수와 같은 의미입니다.',
  '분할 매수 기간': 'DCA 투자 시 전체 금액을 몇 개월에 걸쳐 나눠서 투자할지 결정하는 기간입니다.',

  // 비용 관련
  '수수료': '거래 시 발생하는 비용. 백테스트에서 현실적인 결과를 위해 반영됩니다.',
  '거래 수수료': '주식 매수/매도 시 증권사에 지불하는 수수료. 보통 0.1~0.3% 수준입니다.',
  '슬리피지': '주문 가격과 실제 체결 가격의 차이. 유동성 부족 시 발생할 수 있습니다.',

  // 전략 관련
  '투자 전략': '자산을 매매하는 규칙과 방법. 매수 후 보유, 이동평균 교차 등이 있습니다.',
  '매수보유': 'Buy and Hold. 매수 후 그대로 보유하는 장기투자 전략입니다.',
  '기술적 분석': '과거 가격과 거래량 데이터를 분석하여 미래 가격을 예측하는 방법입니다.',
  '추세 추종': '시장의 추세 방향을 따라가는 전략. 상승장에서 매수, 하락장에서 매도합니다.',
  '평균 회귀': '가격이 평균으로 돌아간다는 가정 하에 거래하는 전략입니다.',

  // 기술적 지표
  'SMA': 'Simple Moving Average. 단순 이동평균선으로 가격 추세 분석에 사용됩니다.',
  'EMA': 'Exponential Moving Average. 최근 가격에 더 큰 가중치를 주는 이동평균입니다.',
  'RSI': 'Relative Strength Index. 과매수/과매도 상태를 판단하는 기술적 지표입니다.',
  'MACD': 'Moving Average Convergence Divergence. 추세와 모멘텀을 동시에 파악하는 지표입니다.',
  '볼린저 밴드': '가격의 변동성을 나타내는 밴드. 상단/하단 터치 시 과매수/과매도 신호입니다.',
  '이동평균': '일정 기간의 평균 가격을 선으로 연결한 기술적 분석 도구입니다.',
  '골든크로스': '단기 이동평균선이 장기 이동평균선을 상향 돌파하는 매수 신호입니다.',
  '데드크로스': '단기 이동평균선이 장기 이동평균선을 하향 돌파하는 매도 신호입니다.',
  '과매수': '가격이 과도하게 상승하여 조정 가능성이 높은 상태. RSI 70 이상이 기준입니다.',
  '과매도': '가격이 과도하게 하락하여 반등 가능성이 높은 상태. RSI 30 이하가 기준입니다.',

  // 기타
  '환율': '두 국가 통화 간의 교환 비율. 해외 투자 시 수익률에 영향을 줍니다.',
  '베타': '시장 대비 개별 자산의 변동성 정도. 1보다 크면 시장보다 변동성이 큽니다.',
  'CAGR': 'Compound Annual Growth Rate. 연평균 복합 성장률로 장기 수익률을 나타냅니다.',
  '벤치마크': '투자 성과를 비교하기 위한 기준 지수. 예: S&P 500, KOSPI',
  '복리': '이자에 이자가 붙는 효과. 장기 투자에서 큰 차이를 만듭니다.',
};

const FinancialTermTooltip: React.FC<FinancialTermTooltipProps> = ({ 
  term, 
  children, 
  className = "" 
}) => {
  const explanation = financialTerms[term];
  
  if (!explanation) {
    return <>{children}</>;
  }

  return (
    <TooltipProvider>
      <Tooltip>
        <TooltipTrigger asChild>
          <span className={`cursor-help border-b border-dotted border-primary text-primary hover:text-primary/80 ${className}`}>
            {children}
          </span>
        </TooltipTrigger>
        <TooltipContent side="top" className="max-w-xs">
          <div className="space-y-1">
            <div className="font-medium">{term}</div>
            <div className="text-sm text-muted-foreground">{explanation}</div>
          </div>
        </TooltipContent>
      </Tooltip>
    </TooltipProvider>
  );
};

export default FinancialTermTooltip;
